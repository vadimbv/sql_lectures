# üî¢ –§—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å —á–∏—Å–ª–∞–º–∏ –≤ PostgreSQL

## –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ

### `ROUND()`
–û–∫—Ä—É–≥–ª—è–µ—Ç —á–∏—Å–ª–æ –¥–æ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π

```sql
-- –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ —Ü–µ–ª–æ–≥–æ
SELECT ROUND(42.567);
-- 43

-- –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ 2 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
SELECT ROUND(42.567, 2);
-- 42.57

-- –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ 1 –∑–Ω–∞–∫–∞
SELECT ROUND(42.567, 1);
-- 42.6

-- –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —á–∏—Å–µ–ª
SELECT ROUND(-42.567, 2);
-- -42.57

-- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Ü–µ–Ω
SELECT 
    product_name,
    ROUND(price * 1.15, 2) as price_with_tax
FROM products;
```

### `CEIL()` / `CEILING()`
–û–∫—Ä—É–≥–ª—è–µ—Ç –≤–≤–µ—Ä—Ö –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–ª–æ–≥–æ

```sql
SELECT CEIL(42.1);
-- 43

SELECT CEIL(42.9);
-- 43

SELECT CEILING(-42.1);
-- -42 (–±–ª–∏–∂–∞–π—à–µ–µ –±–æ–ª—å—à–µ–µ —Ü–µ–ª–æ–µ –¥–ª—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö)

-- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: —Ä–∞—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç—Ä–∞–Ω–∏—Ü
SELECT 
    total_items,
    CEIL(total_items::NUMERIC / 10) as total_pages
FROM reports;
```

### `FLOOR()`
–û–∫—Ä—É–≥–ª—è–µ—Ç –≤–Ω–∏–∑ –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–ª–æ–≥–æ

```sql
SELECT FLOOR(42.9);
-- 42

SELECT FLOOR(42.1);
-- 42

SELECT FLOOR(-42.9);
-- -43 (–±–ª–∏–∂–∞–π—à–µ–µ –º–µ–Ω—å—à–µ–µ —Ü–µ–ª–æ–µ –¥–ª—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö)

-- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º
SELECT 
    FLOOR(age / 10) * 10 as age_group,
    COUNT(*) as count
FROM users
GROUP BY FLOOR(age / 10)
ORDER BY age_group;
```

### `TRUNC()`
–£—Å–µ–∫–∞–µ—Ç —á–∏—Å–ª–æ –¥–æ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–Ω–∞–∫–æ–≤ (–±–µ–∑ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è)

```sql
-- –£—Å–µ—á–µ–Ω–∏–µ –¥–æ —Ü–µ–ª–æ–≥–æ
SELECT TRUNC(42.987);
-- 42

-- –£—Å–µ—á–µ–Ω–∏–µ –¥–æ 2 –∑–Ω–∞–∫–æ–≤
SELECT TRUNC(42.987, 2);
-- 42.98

-- –£—Å–µ—á–µ–Ω–∏–µ –¥–æ 1 –∑–Ω–∞–∫–∞
SELECT TRUNC(42.987, 1);
-- 42.9

-- –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É ROUND –∏ TRUNC
SELECT 
    ROUND(42.987, 2) as rounded,  -- 42.99
    TRUNC(42.987, 2) as truncated; -- 42.98
```

---

## –ë–∞–∑–æ–≤—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### `ABS()`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–º–æ–¥—É–ª—å —á–∏—Å–ª–∞)

```sql
SELECT ABS(-42);
-- 42

SELECT ABS(42);
-- 42

SELECT ABS(-42.567);
-- 42.567

-- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: —Ä–∞—Å—á–µ—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
SELECT 
    product_name,
    target_sales,
    actual_sales,
    ABS(actual_sales - target_sales) as deviation
FROM sales_report;
```

### `SIGN()`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞–∫ —á–∏—Å–ª–∞ (-1, 0, –∏–ª–∏ 1)

```sql
SELECT SIGN(-42);
-- -1

SELECT SIGN(0);
-- 0

SELECT SIGN(42);
-- 1

-- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
SELECT 
    product_name,
    previous_price,
    current_price,
    CASE SIGN(current_price - previous_price)
        WHEN 1 THEN '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ'
        WHEN -1 THEN '–°–Ω–∏–∂–µ–Ω–∏–µ'
        ELSE '–ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π'
    END as price_trend
FROM products;
```

### `MOD()`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è

```sql
SELECT MOD(10, 3);
-- 1

SELECT MOD(17, 5);
-- 2

SELECT MOD(100, 7);
-- 2

-- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–µ—Ç–Ω—ã—Ö/–Ω–µ—á–µ—Ç–Ω—ã—Ö
SELECT 
    order_id,
    CASE WHEN MOD(order_id, 2) = 0 
         THEN '–ß–µ—Ç–Ω—ã–π' 
         ELSE '–ù–µ—á–µ—Ç–Ω—ã–π' 
    END as parity
FROM orders;
```

---

## –°—Ç–µ–ø–µ–Ω—å –∏ –∫–æ—Ä–µ–Ω—å

### `POWER()` / `POW()`
–í–æ–∑–≤–æ–¥–∏—Ç —á–∏—Å–ª–æ –≤ —Å—Ç–µ–ø–µ–Ω—å

```sql
-- 2 –≤ —Å—Ç–µ–ø–µ–Ω–∏ 3
SELECT POWER(2, 3);
-- 8

-- 5 –≤ —Å—Ç–µ–ø–µ–Ω–∏ 2
SELECT POWER(5, 2);
-- 25

-- –î—Ä–æ–±–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å (–∫–æ—Ä–µ–Ω—å)
SELECT POWER(16, 0.5);
-- 4 (–∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å –∏–∑ 16)

-- –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å
SELECT POWER(2, -3);
-- 0.125 (1/8)

-- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: —Å–ª–æ–∂–Ω—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã
SELECT 
    initial_amount,
    ROUND(initial_amount * POWER(1.05, 10), 2) as amount_after_10_years
FROM investments;
```

### `SQRT()`
–í—ã—á–∏—Å–ª—è–µ—Ç –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å

```sql
SELECT SQRT(16);
-- 4

SELECT SQRT(2);
-- 1.4142135623730951

SELECT SQRT(100);
-- 10

-- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏
SELECT 
    point_a,
    point_b,
    SQRT(
        POWER(x2 - x1, 2) + POWER(y2 - y1, 2)
    ) as distance
FROM coordinates;
```

### `CBRT()`
–í—ã—á–∏—Å–ª—è–µ—Ç –∫—É–±–∏—á–µ—Å–∫–∏–π –∫–æ—Ä–µ–Ω—å

```sql
SELECT CBRT(27);
-- 3

SELECT CBRT(64);
-- 4

SELECT CBRT(-8);
-- -2 (–∫—É–±–∏—á–µ—Å–∫–∏–π –∫–æ—Ä–µ–Ω—å –æ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞)
```

---

## –≠–∫—Å–ø–æ–Ω–µ–Ω—Ç–∞ –∏ –ª–æ–≥–∞—Ä–∏—Ñ–º

### `EXP()`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç e –≤ —Å—Ç–µ–ø–µ–Ω–∏ x (—ç–∫—Å–ø–æ–Ω–µ–Ω—Ç–∞)

```sql
SELECT EXP(0);
-- 1

SELECT EXP(1);
-- 2.718281828459045 (—á–∏—Å–ª–æ e)

SELECT EXP(2);
-- 7.38905609893065

-- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç
SELECT 
    year,
    initial_value * EXP(growth_rate * year) as projected_value
FROM growth_projections;
```

### `LN()` / `LOG()`
–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –ª–æ–≥–∞—Ä–∏—Ñ–º –∏ –ª–æ–≥–∞—Ä–∏—Ñ–º –ø–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—é 10

```sql
-- –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –ª–æ–≥–∞—Ä–∏—Ñ–º (–ø–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—é e)
SELECT LN(2.718281828459045);
-- 1

SELECT LN(10);
-- 2.302585092994046

-- –õ–æ–≥–∞—Ä–∏—Ñ–º –ø–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—é 10
SELECT LOG(100);
-- 2

SELECT LOG(1000);
-- 3

-- –õ–æ–≥–∞—Ä–∏—Ñ–º –ø–æ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º—É –æ—Å–Ω–æ–≤–∞–Ω–∏—é: LOG(–æ—Å–Ω–æ–≤–∞–Ω–∏–µ, —á–∏—Å–ª–æ)
SELECT LOG(2, 8);
-- 3 (2 –≤ —Å—Ç–µ–ø–µ–Ω–∏ 3 = 8)

-- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: —Ä–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ —É–¥–≤–æ–µ–Ω–∏—è
SELECT 
    interest_rate,
    LN(2) / LN(1 + interest_rate/100) as years_to_double
FROM accounts;
```

---

## –¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
```sql
-- –°–∏–Ω—É—Å (–∞—Ä–≥—É–º–µ–Ω—Ç –≤ —Ä–∞–¥–∏–∞–Ω–∞—Ö)
SELECT SIN(PI() / 2);
-- 1

-- –ö–æ—Å–∏–Ω—É—Å
SELECT COS(0);
-- 1

-- –¢–∞–Ω–≥–µ–Ω—Å
SELECT TAN(PI() / 4);
-- 1

-- –ö–æ—Ç–∞–Ω–≥–µ–Ω—Å
SELECT COT(PI() / 4);
-- 1

-- –ê—Ä–∫—Å–∏–Ω—É—Å (—Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ä–∞–¥–∏–∞–Ω–∞—Ö)
SELECT ASIN(1);
-- 1.5707963267948966 (œÄ/2)

-- –ê—Ä–∫–∫–æ—Å–∏–Ω—É—Å
SELECT ACOS(0);
-- 1.5707963267948966 (œÄ/2)

-- –ê—Ä–∫—Ç–∞–Ω–≥–µ–Ω—Å
SELECT ATAN(1);
-- 0.7853981633974483 (œÄ/4)

-- –ê—Ä–∫—Ç–∞–Ω–≥–µ–Ω—Å –¥–≤—É—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–≤–∞–¥—Ä–∞–Ω—Ç–∞)
SELECT ATAN2(1, 1);
-- 0.7853981633974483 (œÄ/4)
```

### `DEGREES()` / `RADIANS()`
–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–µ–∂–¥—É –≥—Ä–∞–¥—É—Å–∞–º–∏ –∏ —Ä–∞–¥–∏–∞–Ω–∞–º–∏

```sql
-- –†–∞–¥–∏–∞–Ω—ã –≤ –≥—Ä–∞–¥—É—Å—ã
SELECT DEGREES(PI());
-- 180

SELECT DEGREES(PI() / 2);
-- 90

-- –ì—Ä–∞–¥—É—Å—ã –≤ —Ä–∞–¥–∏–∞–Ω—ã
SELECT RADIANS(180);
-- 3.141592653589793 (œÄ)

SELECT RADIANS(90);
-- 1.5707963267948966 (œÄ/2)
```

### `PI()`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–æ œÄ (–ø–∏)

```sql
SELECT PI();
-- 3.141592653589793

-- –ü–ª–æ—â–∞–¥—å –∫—Ä—É–≥–∞
SELECT PI() * POWER(radius, 2) as circle_area
FROM circles;
```

---

## –°–ª—É—á–∞–π–Ω—ã–µ —á–∏—Å–ª–∞

### `RANDOM()`
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ 1

```sql
SELECT RANDOM();
-- 0.742391873 (—Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ)

-- –°–ª—É—á–∞–π–Ω–æ–µ —Ü–µ–ª–æ–µ –æ—Ç 1 –¥–æ 100
SELECT FLOOR(RANDOM() * 100 + 1)::INTEGER;
-- 47 (—Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 100)

-- –°–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [min, max]
SELECT FLOOR(RANDOM() * (100 - 50 + 1) + 50)::INTEGER;
-- –°–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç 50 –¥–æ 100

-- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: —Å–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞
SELECT * 
FROM products
ORDER BY RANDOM()
LIMIT 10;
```

### `SETSEED()`
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç seed –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª (–¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏)

```sql
-- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å seed
SELECT SETSEED(0.5);

-- –¢–µ–ø–µ—Ä—å RANDOM() –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
SELECT RANDOM();  -- –í—Å–µ–≥–¥–∞ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏ –æ–¥–Ω–æ–º seed
SELECT RANDOM();
SELECT RANDOM();
```

---

## –í—ã–±–æ—Ä –º–∏–Ω–∏–º—É–º–∞ –∏ –º–∞–∫—Å–∏–º—É–º–∞

### `GREATEST()` / `LEAST()`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–∏–±–æ–ª—å—à–µ–µ/–Ω–∞–∏–º–µ–Ω—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞

```sql
-- –ù–∞–∏–±–æ–ª—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
SELECT GREATEST(5, 12, 3, 9);
-- 12

-- –ù–∞–∏–º–µ–Ω—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
SELECT LEAST(5, 12, 3, 9);
-- 3

-- –†–∞–±–æ—Ç–∞ —Å NULL
SELECT GREATEST(5, 12, NULL, 9);
-- NULL (–µ—Å–ª–∏ –µ—Å—Ç—å NULL, —Ä–µ–∑—É–ª—å—Ç–∞—Ç NULL)

-- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π
SELECT 
    product_name,
    price,
    discount,
    GREATEST(price - discount, 0) as final_price  -- –ù–µ –º–µ–Ω—å—à–µ 0
FROM products;

-- –í—ã–±–æ—Ä –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã
SELECT 
    order_id,
    GREATEST(
        requested_date,
        promised_date,
        actual_delivery_date
    ) as latest_date
FROM deliveries;
```

---

## –¶–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ

### `DIV()`
–¶–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ (—Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ –æ—Å—Ç–∞—Ç–∫–∞)

```sql
SELECT DIV(10, 3);
-- 3

SELECT DIV(17, 5);
-- 3

SELECT DIV(100, 7);
-- 14

-- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–±—ã—á–Ω—ã–º –¥–µ–ª–µ–Ω–∏–µ–º –∏ –æ—Å—Ç–∞—Ç–∫–æ–º
SELECT 
    17 / 5 as division,        -- 3 (—Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ) –∏–ª–∏ 3.4 (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–æ–≤)
    DIV(17, 5) as div_result,  -- 3
    MOD(17, 5) as remainder;   -- 2
```

---

## –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

### `FACTORIAL()`
–í—ã—á–∏—Å–ª—è–µ—Ç —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª —á–∏—Å–ª–∞

```sql
SELECT FACTORIAL(5);
-- 120 (5! = 5 √ó 4 √ó 3 √ó 2 √ó 1)

SELECT FACTORIAL(0);
-- 1

SELECT FACTORIAL(10);
-- 3628800
```

### `GCD()` / `LCM()`
–ù–∞–∏–±–æ–ª—å—à–∏–π –æ–±—â–∏–π –¥–µ–ª–∏—Ç–µ–ª—å –∏ –Ω–∞–∏–º–µ–Ω—å—à–µ–µ –æ–±—â–µ–µ –∫—Ä–∞—Ç–Ω–æ–µ

```sql
-- –ù–∞–∏–±–æ–ª—å—à–∏–π –æ–±—â–∏–π –¥–µ–ª–∏—Ç–µ–ª—å
SELECT GCD(12, 18);
-- 6

SELECT GCD(100, 50);
-- 50

-- –ù–∞–∏–º–µ–Ω—å—à–µ–µ –æ–±—â–µ–µ –∫—Ä–∞—Ç–Ω–æ–µ
SELECT LCM(12, 18);
-- 36

SELECT LCM(4, 6);
-- 12
```

### `WIDTH_BUCKET()`
–†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –∫–æ—Ä–∑–∏–Ω–∞–º (buckets)

```sql
-- –†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á–∏—Å–ª–æ 5 –≤ 10 –∫–æ—Ä–∑–∏–Ω –æ—Ç 0 –¥–æ 100
SELECT WIDTH_BUCKET(5, 0, 100, 10);
-- 1 (–ø–µ—Ä–≤–∞—è –∫–æ—Ä–∑–∏–Ω–∞)

SELECT WIDTH_BUCKET(55, 0, 100, 10);
-- 6 (—à–µ—Å—Ç–∞—è –∫–æ—Ä–∑–∏–Ω–∞)

-- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: —Å–æ–∑–¥–∞–Ω–∏–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã
SELECT 
    WIDTH_BUCKET(salary, 0, 100000, 10) as salary_bucket,
    COUNT(*) as employee_count
FROM employees
GROUP BY WIDTH_BUCKET(salary, 0, 100000, 10)
ORDER BY salary_bucket;
```

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –†–∞—Å—á–µ—Ç —Å–∫–∏–¥–∫–∏ —Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º
```sql
SELECT 
    product_name,
    original_price,
    discount_percent,
    ROUND(original_price * (1 - discount_percent/100), 2) as discounted_price,
    ROUND(original_price * discount_percent/100, 2) as discount_amount,
    ROUND(original_price - (original_price * discount_percent/100), 2) as final_price
FROM products
WHERE discount_percent > 0;
```

### –ü—Ä–∏–º–µ—Ä 2: –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–∞—Å—á–µ—Ç—ã
```sql
SELECT 
    invoice_id,
    subtotal,
    -- –ù–î–° 20%
    ROUND(subtotal * 0.20, 2) as vat,
    -- –ò—Ç–æ–≥–æ
    ROUND(subtotal * 1.20, 2) as total,
    -- –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ —Ä—É–±–ª–µ–π
    ROUND(subtotal * 1.20, 0) as total_rounded
FROM invoices;
```

### –ü—Ä–∏–º–µ—Ä 3: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É GPS –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (—Ñ–æ—Ä–º—É–ª–∞ Haversine —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è)
```sql
SELECT 
    location_a,
    location_b,
    ROUND(
        6371 * ACOS(
            COS(RADIANS(lat1)) * COS(RADIANS(lat2)) * 
            COS(RADIANS(lon2) - RADIANS(lon1)) + 
            SIN(RADIANS(lat1)) * SIN(RADIANS(lat2))
        ),
        2
    ) as distance_km
FROM locations;
```

### –ü—Ä–∏–º–µ—Ä 4: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–æ—Ç 0 –¥–æ 1)
```sql
WITH stats AS (
    SELECT 
        MIN(score) as min_score,
        MAX(score) as max_score
    FROM test_results
)
SELECT 
    student_name,
    score,
    ROUND(
        (score - stats.min_score)::NUMERIC / 
        NULLIF(stats.max_score - stats.min_score, 0),
        4
    ) as normalized_score
FROM test_results, stats;
```

### –ü—Ä–∏–º–µ—Ä 5: –†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
```sql
SELECT 
    product_name,
    last_year_sales,
    current_year_sales,
    ROUND(
        ((current_year_sales - last_year_sales)::NUMERIC / 
        NULLIF(last_year_sales, 0)) * 100,
        2
    ) as percent_change,
    CASE 
        WHEN current_year_sales > last_year_sales THEN '‚Üë'
        WHEN current_year_sales < last_year_sales THEN '‚Üì'
        ELSE '='
    END as trend
FROM annual_sales;
```

### –ü—Ä–∏–º–µ—Ä 6: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
INSERT INTO test_orders (order_id, quantity, price)
SELECT 
    generate_series(1, 1000),
    FLOOR(RANDOM() * 100 + 1)::INTEGER as quantity,
    ROUND((RANDOM() * 1000)::NUMERIC, 2) as price;
```

### –ü—Ä–∏–º–µ—Ä 7: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
```sql
SELECT 
    initial_investment,
    annual_rate,
    years,
    ROUND(
        initial_investment * POWER(1 + annual_rate/100, years),
        2
    ) as future_value,
    ROUND(
        initial_investment * POWER(1 + annual_rate/100, years) - initial_investment,
        2
    ) as interest_earned
FROM investments;
```

### –ü—Ä–∏–º–µ—Ä 8: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–≤–∞–¥—Ä–∞–Ω—Ç–∞ —É–≥–ª–∞
```sql
SELECT 
    angle_degrees,
    CASE 
        WHEN angle_degrees >= 0 AND angle_degrees < 90 THEN 'I –∫–≤–∞–¥—Ä–∞–Ω—Ç'
        WHEN angle_degrees >= 90 AND angle_degrees < 180 THEN 'II –∫–≤–∞–¥—Ä–∞–Ω—Ç'
        WHEN angle_degrees >= 180 AND angle_degrees < 270 THEN 'III –∫–≤–∞–¥—Ä–∞–Ω—Ç'
        WHEN angle_degrees >= 270 AND angle_degrees < 360 THEN 'IV –∫–≤–∞–¥—Ä–∞–Ω—Ç'
    END as quadrant,
    RADIANS(angle_degrees) as angle_radians,
    ROUND(SIN(RADIANS(angle_degrees))::NUMERIC, 4) as sin_value,
    ROUND(COS(RADIANS(angle_degrees))::NUMERIC, 4) as cos_value
FROM angles;
```

### –ü—Ä–∏–º–µ—Ä 9: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ª–∏–º–æ—Å—Ç–∏
```sql
SELECT 
    number,
    CASE 
        WHEN MOD(number, 15) = 0 THEN 'FizzBuzz'
        WHEN MOD(number, 3) = 0 THEN 'Fizz'
        WHEN MOD(number, 5) = 0 THEN 'Buzz'
        ELSE number::TEXT
    END as fizzbuzz
FROM generate_series(1, 100) as number;
```

### –ü—Ä–∏–º–µ—Ä 10: –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Ü–µ–Ω –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞
```sql
SELECT 
    product_name,
    calculated_price,
    -- –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ .99
    CASE 
        WHEN calculated_price < 10 THEN 
            FLOOR(calculated_price) + 0.99
        WHEN calculated_price < 100 THEN 
            FLOOR(calculated_price / 10) * 10 + 9.99
        ELSE 
            FLOOR(calculated_price / 100) * 100 + 99.99
    END as marketing_price
FROM products;
```

---

## –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

```sql
-- –ß–∏—Å–ª–æ œÄ (–ø–∏)
SELECT PI();
-- 3.141592653589793

-- –ß–∏—Å–ª–æ e (–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞)
SELECT EXP(1);
-- 2.718281828459045

-- –ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å
SELECT 'Infinity'::NUMERIC;
SELECT '-Infinity'::NUMERIC;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å
SELECT 
    value,
    value = 'Infinity'::NUMERIC as is_infinity
FROM numeric_values;
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã

| –û–ø–µ—Ä–∞—Ç–æ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|----------|----------|--------|-----------|
| `+` | –°–ª–æ–∂–µ–Ω–∏–µ | `5 + 3` | 8 |
| `-` | –í—ã—á–∏—Ç–∞–Ω–∏–µ | `5 - 3` | 2 |
| `*` | –£–º–Ω–æ–∂–µ–Ω–∏–µ | `5 * 3` | 15 |
| `/` | –î–µ–ª–µ–Ω–∏–µ | `5 / 2` | 2 (—Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ) –∏–ª–∏ 2.5 |
| `%` | –û—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è | `5 % 2` | 1 |
| `^` | –í–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç–µ–ø–µ–Ω—å | `2 ^ 3` | 8 |
| `\|/` | –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å | `\|/ 25` | 5 |
| `\|\|/` | –ö—É–±–∏—á–µ—Å–∫–∏–π –∫–æ—Ä–µ–Ω—å | `\|\|/ 27` | 3 |
| `@` | –ê–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | `@ -5` | 5 |
| `!` | –§–∞–∫—Ç–æ—Ä–∏–∞–ª | `5 !` | 120 |
| `!!` | –§–∞–∫—Ç–æ—Ä–∏–∞–ª (–ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–π) | `!! 5` | 120 |